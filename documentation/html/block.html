<DOCTYPE! html>
<html lang="fr-CA">
<head>
</head>
<body>
<h1>block</h1><p id="BLK">
<b>BLK</b>  ; ( -- a-addr)  
<div style="margin-left:5%;">   Variable qui contient le no de bloc  
</div>
<div style="margin-left:5%;">   actuellement interprété
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  adresse de la variable _blk
</div>
<hr>
<p id="SCR">
<b>SCR</b> ( -- a-addr )
<div style="margin-left:5%;">   variable contenant le dernier numéro de bloc listé.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun</i>&nbsp;&nbsp;    
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   adresse de la variable _scr
</div>
<hr>
<p id="BLKDEV">
<b>BLKDEV</b>  ( -- a-addr )
<div style="margin-left:5%;">    variable contenant l'adresse du descripteur du périphérique
</div>
<div style="margin-left:5%;">    de stockage actif.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *device, adresse de la variable _block_dev
</div>
<hr>
<p id="BUFARRAY">
<b>BUFARRAY</b>  ( -- a-ddr )
<div style="margin-left:5%;">   Retourne l'adresse du tableau
</div>
<div style="margin-left:5%;">   contenant les structures BUFFER    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;    *BUFFER[] adresse de la variable _blk_buffers
</div>
<hr>
<p id="STRUCADR">
<b>STRUCADR</b> ( n -- a-addr)
<div style="margin-left:5%;">   convertie no de buffer en adresse début structure
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp;   no de buffer
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *BUFFER adresse début de la structure
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; STRUCADR, HWORD ; ( n -- u )
</div>
<hr>
<p id="DATA">
<b>DATA</b> ( a-addr1 -- a-addr2 )
<div style="margin-left:5%;">   Retourne un pointeur sur le début du bloc de données du BUFFER.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr1</i>&nbsp;&nbsp;   *BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr2</i>&nbsp;&nbsp;   *data adresse début du bloc de données.
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; DATA,HWORD 
</div>
<hr>
<p id="OWN?">
<b>OWN?</b>  ( n+ u a-addr -- f )
<div style="margin-left:5%;">    Vérifie si le no. de bloc et l'identifiant périphique correspondent
</div>
<div style="margin-left:5%;">    à ce buffer.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;      numéro de block
</div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;       *device  périphérique de stockage
</div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *BUFFER adresse de la structure BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;    indicateur booléen vrai si n+==BLOCK_NBR && u==DEVICE
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; OWNQ,HWORD
</div>
<hr>
<p id="BUFFERED?">
<b>BUFFERED?</b>  ( n+ u -- a-addr|0)
<div style="margin-left:5%;">   vérifie si le bloc est dans un buffer
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;  numéro du bloc recherché.    
</div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;   *device périphérique auquel appartien ce bloc.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *BUFFER  buffer contenant ce bloc ou 0
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; BUFFEREDQ, HWORD
</div>
<hr>
<p id="NOTUSED">
<b>NOTUSED</b> ( -- a-addr|0 )
<div style="margin-left:5%;">   Recherche un buffer libre
</div>
<div style="margin-left:5%;">   si le champ BLOCK_NBR==0 le bloc est libre.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *BUFFER  buffer libre ou 0
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; NOTUSED, HWORD
</div>
<hr>
<p id="OLDEST">
<b>OLDEST</b> ( -- a-addr )
<div style="margin-left:5%;">   recherche le buffer dont la dernière
</div>
<div style="margin-left:5%;">   modification est la plus ancienne i.e. min(UPDATED).
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   *BUFFER    
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; OLDEST,HWORD 
</div>
<hr>
<p id="UPDATED@">
<b>UPDATED@</b>  ( a-addr -- u )
<div style="margin-left:5%;">   retourne la valeur du champ UPDATED
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  *BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp; valeur du champ UPDATED  
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; UPDATEDFETCH, HWORD 
</div>
<hr>
<p id="BLKDEV@">
<b>BLKDEV@</b>  ( -- u )
<div style="margin-left:5%;">   retourne le descripteur du périphérique de stockage actif.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;    descripteur du périphérique
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; BLKDEVFETCH,HWORD 
</div>
<hr>
<p id="BLK&gt;ADR">
<b>BLK&gt;ADR</b> ( a-addr -- ud )
<div style="margin-left:5%;">   Convertie un numéro de bloc d'un buffer en adresse 32 bits. Qui correspond
</div>
<div style="margin-left:5%;">   à la position absolue sur le média de stockage.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>ud</i>&nbsp;&nbsp;  adresse 32 bits sur le périphérique de stockage    
</div>
<hr>
<p id="FIELDS">
<b>FIELDS</b>  ( a-addr -- u1 u2 u3 a-addr )
<div style="margin-left:5%;">   Obtient les paramètres du buffer à partir de son numéro
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   adresse de la structure BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u1</i>&nbsp;&nbsp;    champ DATA
</div>
<div style="margin-left:5%;"><i>u2</i>&nbsp;&nbsp;    champ BLOCK_NBR    
</div>
<div style="margin-left:5%;"><i>u3</i>&nbsp;&nbsp;    champ DEVICE
</div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;    adresse de la structure BUFFER
</div>
<hr>
<p id="UPDATE">
<b>UPDATE</b>  ( a-addr -- )
<div style="margin-left:5%;">    Met à jour le compteur UPDATED avec la valeur
</div>
<div style="margin-left:5%;">    incrémentée de _update_cntr
</div>
<div style="margin-left:5%;"> paramètre:
</div>
<div style="margin-left:5%;">    a-addr   *BUFFER structure buffer
</div>
<div style="margin-left:5%;"> retourne:    
</div>
<div style="margin-left:5%;">   rien
</div>
</p>
<hr>
<p id="NOUPDATE">
<b>NOUPDATE</b>  ( a-addr -- )
<div style="margin-left:5%;">    Remet le champ UPDATED à zéro
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;     *BUFFER  adresse de la structure
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="DATA&gt;">
<b>DATA&gt;</b> ( a-addr -- )    
<div style="margin-left:5%;">   Sauvegarde du data sur stockage
</div>
<div style="margin-left:5%;">   remise à zéro du champ UPDATED.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   *BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp; 
</div>
<hr>
<p id=""&gt;DATA"">
<b>"&gt;DATA"</b>  ( a-addr -- )
<div style="margin-left:5%;">   Charge un bloc dans la RAM. La structure BUFFER indentifié par n
</div>
<div style="margin-left:5%;">   doit contenir le numéro du bloc et le descripteur device.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;    *BUFFER
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;  
</div>
<hr>
<p id="ASSIGN">
<b>ASSIGN</b>  ( n+ -- a-addr )
<div style="margin-left:5%;">   Assigne un BUFFER à un bloc appartenant au périphérique sélectionné par
</div>
<div style="margin-left:5%;">   BLKDEV. Libère un BUFFER au besoin.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;  numéro du bloc requis.    
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   Pointeur sur la structure BUFFER
</div>
<hr>
<p id="BUFFER">
<b>BUFFER</b>  ( n+ -- a-addr )
<div style="margin-left:5%;">   Retourne l'adresse d'un bloc de données. Si aucun buffer n'est disponible
</div>
<div style="margin-left:5%;">   libère celui qui à la plus petite valeur UPDATED.
</div>
<div style="margin-left:5%;">   Contrairement à BLOCK il n'y a pas de lecture du périphérique de stockage.
</div>
<div style="margin-left:5%;">   le contenu du buffer est mis à zéro.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;    numéro du bloc.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   adresse début de la zone de données.
</div>
<hr>
<p id="BLOCK">
<b>BLOCK</b>  ( n+ -- a-addr )
<div style="margin-left:5%;">    Retourne l'adresse d'un buffer pour le bloc.
</div>
<div style="margin-left:5%;">    Le no. de bloc est stocké dans la variable BLK
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;   no. du bloc requis.
</div>
<div style="margin-left:5%;"><b> retourne:    
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  Adresse du début de la zone de données.    
</div>
<hr>
<p id="LOAD">
<b>LOAD</b> ( n+ -- )
<div style="margin-left:5%;">   Évalue un bloc. Charge le bloc en mémooire si requis.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;   numéro du bloc à évaluer.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="SAVE-BUFFERS">
<b>SAVE-BUFFERS</b> ( -- )  
<div style="margin-left:5%;">   Sauvegarde tous les buffers qui ont été modifiés.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="EMPTY-BUFFERS">
<b>EMPTY-BUFFERS</b>  ( -- )
<div style="margin-left:5%;">   Libère tous les BUFFERs sans sauvegarder.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp; 
</div>
<hr>
<p id="FLUSH">
<b>FLUSH</b> ( -- )
<div style="margin-left:5%;">   Sauvegarde tous les BUFFER et et les libères.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp; 
</div>
<hr>
<p id="LIST">
<b>LIST</b> ( n+ -- )
<div style="margin-left:5%;">   Affiche le contenu du bloc à l'écran.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;  numéro du bloc
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="REFILL">
<b>REFILL</b>  ( -- f )
<div style="margin-left:5%;">   **comportement non standard**  
</div>
<div style="margin-left:5%;">   Si la variable BLK est à zéro retourne faux.
</div>
<div style="margin-left:5%;">   Sinon incrémente BLK et si cette nouvelle valeur est valide
</div>
<div style="margin-left:5%;">   charge ce bloc pour évaluation et retourne vrai, sinon
</div>
<div style="margin-left:5%;">   remet BLK à zéro et retourne faux.
</div>
</p>
<hr>
<p id="THRU">
<b>THRU</b>  ( i*x u1 u2 -- j*x )
<div style="margin-left:5%;">   Interprétation des blocs u1 à u2 .
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>i*x</i>&nbsp;&nbsp;  État initial de pile.
</div>
<div style="margin-left:5%;"><i>u1</i>&nbsp;&nbsp;   premier bloc à interpréter.
</div>
<div style="margin-left:5%;"><i>u2</i>&nbsp;&nbsp;   dernier bloc à interpréter.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>j*x</i>&nbsp;&nbsp;  État de la pile après l'interprétation des blocs.
</div>
<hr>
<p id="ADD-CR">
<b>ADD-CR</b>    
<div style="margin-left:5%;">   ajoute un CR à la fin de la ligne
</div>
<div style="margin-left:5%;">   incrémente u de 1
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp;   adresse début chaîne
</div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;        longueur chaîne
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp;   adresse début chaîne
</div>
<div style="margin-left:5%;"><i>u'</i>&nbsp;&nbsp;       u+1    
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; ADD_CR,HWORD ;( c-addr u -- c-addr u' )
</div>
<hr>
<p id="&gt;PAD">
<b>&gt;PAD</b> ( c-addr -- u )    
<div style="margin-left:5%;">   copie la chaîne dans PAD, trim et vérifie vérifie que total+u' &lt;= BUFFER_SIZE
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp;  adresse début ligne dans frame buffer vidéo
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;       longueur de la chaîne tronquée qui est dans PAD    
</div>
<div style="margin-left:5%;"><i>HEADLESS</i>&nbsp;&nbsp; TOPAD,HWORD ; ( c-addr -- u  )
</div>
<hr>
<p id="SCR&gt;BLK">
<b>SCR&gt;BLK</b>  ( n+ -- f )
<div style="margin-left:5%;">   Sauvegarde du frame buffer de l'écran dans un bloc*.
</div>
<div style="margin-left:5%;">   Si l'écran a plus de 1024 caractères seul les 1024 premiers sont sauvegarder.
</div>
<div style="margin-left:5%;">   Les espaces qui termines les lignes sont supprimés et chaque ligne est complétée
</div>
<div style="margin-left:5%;">   par un VK_CR.
</div>
<div style="margin-left:5%;">   * ne fonctionne qu'avec LOCAL CONSOLE. Cependant BLKEDIT utilise le frame buffer
</div>
<div style="margin-left:5%;">     local même lorsque la console est en mode REMOTE, donc BLKEDIT peut sauvegarder
</div>
<div style="margin-left:5%;">     le bloc en édition.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;    numéro du bloc où sera sauvegardé l'écran.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;     indicateur booléen, si l'écran requière plus d'un bloc retourne faux.
</div>
<hr>
<p id="BLKEDIT">
<b>BLKEDIT</b>  ( n+ -- )
<div style="margin-left:5%;">   Edition d'un bloc contenant du texte.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;   numéro du bloc à éditer.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>

</body>
</html>
