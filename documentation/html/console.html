<DOCTYPE! html>
<html lang="fr-CA">
<head>
</head>
<body>
<h1>console</h1><h2>Description</h2><div style="margin-left:5%;"> 
</div>
<div style="margin-left:5%;">    Fonctions associées à la console.
</div>
<div style="margin-left:5%;">    Système de console basé sur des tables de vecteurs pour chaque
</div>
<div style="margin-left:5%;">    type de terminal. les tables contiennent le XT de chaque fonction.
</div>
<div style="margin-left:5%;">    Les fonctions sont celles définies dans le standard DPANS-94
</div>
<div style="margin-left:5%;">REF: <a href=" http://lars.nocrew.org/dpans/dpans10.htm#10.6.1
"> http://lars.nocrew.org/dpans/dpans10.htm#10.6.1
</a></div>
<div style="margin-left:5%;">
</div>
<div style="margin-left:5%;">    Il a 2 terminaux, la console LOCAL constituée du clavier et du moniteur
</div>
<div style="margin-left:5%;">    branché à l'ordinateur ForthEx et la REMOTE qui utilise le port sériel RS-232
</div>
<div style="margin-left:5%;">    pour se connecté à un PC qui utilise à émulateur de terminal VT102.
</div>
<div style="margin-left:5%;">    On passe d'une console à l'autre avec les 2 phrases suivantes:
</div>
<div style="margin-left:5%;">    REMOTE CONSOLE  \ l'interface utilisateur utilise le port sériel.
</div>
<div style="margin-left:5%;">    LOCAL CONSOLE   \ l'interface utilisateur utilise le clavier et le moniteur
</div>
<div style="margin-left:5%;">                    \ de l'ordinateur ForthEx. C'est la console par défaut.    
</div>
<div style="margin-left:5%;">
</div>
<div style="margin-left:5%;">    La variable système SYSCONS contient le vecteur de la console sélectionnée.
</div>
<div style="margin-left:5%;">    Ce vecteur est une table contenant les fonctions à exécuter pour chacun des
</div>
<div style="margin-left:5%;">    mots définis dans DPANS-94, tel qu'indiquer dans la table suivante.
</div>
<div style="margin-left:5%;">        
</div>
<div style="margin-left:5%;">FNBR   NOM       LCONCOLE     RCONCOLE
</div>
<div style="margin-left:5%;">       DPANS-94    CFA          CFA
</div>
<div style="margin-left:5%;">========================================
</div>
<div style="margin-left:5%;">0      KEY        LC-KEY       VT-KEY
</div>
<div style="margin-left:5%;">1      KEY?       LC-KEY?      VT-CHAR?
</div>
<div style="margin-left:5%;">2      EKEY       LC-EKEY      VT-ECHAR
</div>
<div style="margin-left:5%;">3      EKEY?      LC-EKEY?     SGETC?
</div>
<div style="margin-left:5%;">4      EMIT       LC-EMIT      VT-EMIT
</div>
<div style="margin-left:5%;">5      EMIT?      LC-EMIT?     VT-EMIT?    
</div>
<div style="margin-left:5%;">6      AT-XY      CURPOS       VT-AT-XY
</div>
<div style="margin-left:5%;">7      PAGE       CLS          VT-PAGE
</div>
<div style="margin-left:5%;">8      EKEY>CHAR  LC-FILTER    VT-FILTER
</div>
<div style="margin-left:5%;">9                 LC-GETCUR    VT-GETCUR
</div>
<hr style:"border-width:2px;"><p id="LOCAL">
<b>LOCAL</b> ( -- a-addr )
<div style="margin-left:5%;">   Empile le vecteur de la table LCONSOLE qui sert d'argument pour CONSOLE.
</div>
<div style="margin-left:5%;">   Efface l'écran local.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  adresse de la table LCONSOLE    
</div>
<hr>
<p id="REMOTE">
<b>REMOTE</b> ( -- a-addr )
<div style="margin-left:5%;">   Empile le vecteur de la table LREMOTE qui sert d'argument pour CONSOLE.
</div>
<div style="margin-left:5%;">   Envoie une commande au terminal VT102 pour effacer l'écran.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;  adresse de la table LREMOTE    
</div>
<hr>
<p id="CONSOLE">
<b>CONSOLE</b> ( a-addr --  )
<div style="margin-left:5%;">   Détermine la console active. 
</div>
<div style="margin-left:5%;">   Cette information est enregistrée dans la variable système SYSCONS    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp;   adresse de la table des fonctions de la nouvelle console.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;   
</div>
<hr>
<p id="KEY">
<b>KEY</b>  ( -- c )  
<div style="margin-left:5%;">   Lecture d'un caractère à partir de la console active
</div>
<div style="margin-left:5%;">   les caractères invalides sont rejetés jusqu'à la réception
</div>
<div style="margin-left:5%;">   d'un caractère valide. Les caractères valides sont les
</div>
<div style="margin-left:5%;">   caractères ASCII {32..126}. Pour accepter tous les caractères
</div>
<div style="margin-left:5%;">   Il faut utiliser EKEY.
</div>
<div style="margin-left:5%;">   Attend indéfiniement la réception d'un caractère.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b>  retourne:
</b></div>
<div style="margin-left:5%;"><i>c</i>&nbsp;&nbsp;   caractère reçu de la console 
</div>
<hr>
<p id="KEY?">
<b>KEY?</b>  ( -- f )
<div style="margin-left:5%;">   Retourne vrai si un caractère valide est disponible.
</div>
<div style="margin-left:5%;">   S'il y a des caractères non valides dans la file ils
</div>
<div style="margin-left:5%;">   sont jetés et rendus indisponibles.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;   booléen VRAI|FAUX
</div>
<hr>
<p id="EKEY">
<b>EKEY</b>  ( -- c )
<div style="margin-left:5%;">  Réception d'un événement clavier incluant les codes de 
</div>
<div style="margin-left:5%;">  contrôles. Attend indéfiniment la réception d'un caractère.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>c</i>&nbsp;&nbsp;   caractère reçu
</div>
<hr>
<p id="EKEY?">
<b>EKEY?</b> ( -- f )
<div style="margin-left:5%;">   Vérifie s'il y a un caractère dans la file de réception de la console.
</div>
<div style="margin-left:5%;">   Retourne un booléen indiquant l'état.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;   booléen VRAI|FAUX
</div>
<hr>
<p id="EMIT">
<b>EMIT</b> ( c -- )
<div style="margin-left:5%;">  transmet un caractère à la console. Les caractères sont filtrés.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c</i>&nbsp;&nbsp;   caractère à transmettre.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="EMIT?">
<b>EMIT?</b> ( -- f )
<div style="margin-left:5%;">  Vérifie si le terminal est prêt à recevoir. La console locale retourne toujours VRAI.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;      indicateur booléen FALSE|TRUE
</div>
<hr>
<p id="AT-XY">
<b>AT-XY</b> ( u1 u2 -- )
<div style="margin-left:5%;">   Positionne le curseur de la console aux coordonnées {u1,u2}.
</div>
<div style="margin-left:5%;">   Pour la console locale la numérotation commence à zéro mais pour le
</div>
<div style="margin-left:5%;">   terminal VT102 la numérotation commence à 1.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>u1</i>&nbsp;&nbsp;   colonne 
</div>
<div style="margin-left:5%;"><i>u2</i>&nbsp;&nbsp;   ligne
</div>
<div style="margin-left:5%;"><b>  retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="PAGE">
<b>PAGE</b> ( -- )
<div style="margin-left:5%;">   Efface l'écran de la console.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="EKEY&gt;CHAR">
<b>EKEY&gt;CHAR</b> ( u -- u false | char true )
<div style="margin-left:5%;">   convertie un code reçu de la console en caractère affichable.
</div>
<div style="margin-left:5%;">   Si le code est valide. Le code u doit répondre au critères du filtre.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;  code reçu de la console
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp; FALSE  si le code n'est pas dans l'ensemble {32..126} VK_CR, VK_BACK
</div>
<div style="margin-left:5%;"><i>c</i>&nbsp;&nbsp; TRUE   si le code est dans l'ensemble reconnu par le filtre.
</div>
<hr>
<p id="SPACE">
<b>SPACE</b> ( -- )
<div style="margin-left:5%;">   Imprime un espace sur la console.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="SPACES">
<b>SPACES</b> ( n -- )
<div style="margin-left:5%;">   Imprime n espaces sur la console.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="CLEARLN">
<b>CLEARLN</b> 
<div style="margin-left:5%;">   Efface la ligne sur laquelle le curseur est situé.
</div>
<div style="margin-left:5%;">   Place le curseur au début de la ligne.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<hr>
<p id="TYPE">
<b>TYPE</b> ( c-addr n+ -- )
<div style="margin-left:5%;">  Imprime une chaîne à l'écran de la console active.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp;  adresse du premier caractère de la chaîne.
</div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;   Longueur de la chaîne. 
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="DELETE">
<b>DELETE</b>  ( -- )
<div style="margin-left:5%;">   Supprime le caractère à la position du cureur.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="DELBACK">
<b>DELBACK</b>  ( -- )
<div style="margin-left:5%;">   Supprime le caractère à gauche du curseur et recule le curseur d'une position.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="DELLINE">
<b>DELLINE</b>  ( -- )    
<div style="margin-left:5%;">   Supprime la ligne sur laquelle le curseur est positionné.
</div>
<div style="margin-left:5%;">   Renvoie le curseur en début de ligne.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="CR">
<b>CR</b> ( -- )    
<div style="margin-left:5%;">   Renvoie le curseur au début de la ligne suivante.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="CLS">
<b>CLS</b>  ( -- )    
<div style="margin-left:5%;">   Efface l'écran de la console.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<hr>
<p id="GETCUR">
<b>GETCUR</b>  ( -- u1 u2 )
<div style="margin-left:5%;">   retourne la position du curseur texte.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u1</i>&nbsp;&nbsp;    colonne  locale {0..63} remote {1..64}
</div>
<div style="margin-left:5%;"><i>u2</i>&nbsp;&nbsp;    ligne    locale {0..23} remote {1..24}
</div>
<hr>

</body>
</html>
