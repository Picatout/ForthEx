<DOCTYPE! html>
<html lang="fr-CA">
<head>
</head>
<body id="#top">
<h1>sdcard</h1><div><a href="#index">index</a></div>
<div><a href="index.html">index principal</a></div>
<h2 id="description">Description</h2><div style="margin-left:5%;">  
</div>
<div style="margin-left:5%;"> Interface de bas niveau pour l'accès à la carte SD.
</div>
<div style="margin-left:5%;"> Permet l'initialisation de la carte ainsi que la lecture et l'écriture d'un bloc de
</div>
<div style="margin-left:5%;"> donnée sur la carte. Cette interface n'est compatible qu'avec les cartes SD V1 et V2.
</div>
<div style="margin-left:5%;">REF: <a href=" http://elm-chan.org/docs/mmc/mmc_e.html
"> http://elm-chan.org/docs/mmc/mmc_e.html
</a></div>
<div style="margin-left:5%;">REF: <a href=" http://elm-chan.org/docs/mmc/pic/sdinit.png    
"> http://elm-chan.org/docs/mmc/pic/sdinit.png    
</a></div>
<div style="margin-left:5%;">REF: <a href=" https://www.sdcard.org/downloads/pls/
"> https://www.sdcard.org/downloads/pls/
</a></div>
<div style="margin-left:5%;">  <br>
</div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:4px;"><p id="CARD-INFO">
<b>CARD-INFO</b>  ( -- )
<div style="margin-left:5%;">   Affiche les informations sur la carte SD.
</div>
<div style="margin-left:5%;">   La carte doit d'abord avoir été initialisée avec SDC-INIT.
</div>
<div style="margin-left:5%;">  <br><table border="single">
</div>
<div style="margin-left:5%;">  <tr><th>nom</th><th>description</th></tr>  
</div>
<div style="margin-left:5%;">  <tr><td>VER</td><td> Card version.</td></tr>  
</div>
<div style="margin-left:5%;">  <tr><td>MID</td><td> Manufacturer ID.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>OID</td><td> OEM/Application ID.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>PNM</td><td> Product name.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>PRV</td><td> Product revision.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>PSN</td><td> Product serial number.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>MTD</td><td> Manufacturing date.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>BLK</td><td> Capacitée en nombre de blocs de 1024 octets.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td>SEG</td><td> Nombre de segments, 1 segment correspond à 65535 blocs.</td></tr>    
</div>
<div style="margin-left:5%;">  </table><br> 
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-R">
<b>SDC-R</b> ( -- a-addr )
<div style="margin-left:5%;">   Adresse de la mémoire tampon de 16 octets qui reçois les réponses de la carte SD.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp; Adresse du tampon réponse carte SD.
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-INIT">
<b>SDC-INIT</b> ( -- f )
<div style="margin-left:5%;">   Initialisation carte SD 
</div>
<div style="margin-left:5%;">REF: <a href=" http://elm-chan.org/docs/mmc/pic/sdinit.png    
"> http://elm-chan.org/docs/mmc/pic/sdinit.png    
</a></div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;   Indicateur Booléen, vrai si l'initialisation est réussie.   
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SEGMENT">
<b>SEGMENT</b> ( u -- )
<div style="margin-left:5%;">   Détermine quel segment de la carte est actif.
</div>
<div style="margin-left:5%;">   Le système définit dans block.s ne permet que d'accéder 65535 blocs sur un périphérique
</div>
<div style="margin-left:5%;">   ce qui représente 1024*65535 ou 2^10 * (2^16-1)= 67 107 840 octets hors les plus petites
</div>
<div style="margin-left:5%;">   cartes disponible de nos jours sont de 2Go. ForthEx divise donc les cartes 
</div>
<div style="margin-left:5%;">   en segments de 65535 blocs.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp; Numéro du segment.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SEGMENT?">
<b>SEGMENT?</b> ( -- u )
<div style="margin-left:5%;">   Retourne le numéro du segment actif.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u	Numéro</i>&nbsp;&nbsp; du segment actif {0..SDC-SEGMENTS-1}    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="?SDC">
<b>?SDC</b>  ( -- u )    
<div style="margin-left:5%;">   Retourne un entier non signé contenant les indicateurs booléen suivants
</div>
<div style="margin-left:5%;">  <br><table border="single">    
</div>
<div style="margin-left:5%;">  <tr><th><center>bit</center></th><th>nom</th><th>description</th></tr>    
</div>
<div style="margin-left:5%;">  <tr><td><center>0</center></td><td>F_SDC_IN</td><td>1 &rarr; S'il y a une carte dans la fente.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>1</center></td><td>F_SDC_OK</td><td>1 &rarr; Si la carte est initialisée.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>2</center></td><td>F_SDC_V2</td><td>1  &rarr; S'il s'agit d'une carte version 2.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>3</center></td><td>F_SDC_HC</td><td>1 &rarr; S'il s'agit d'une carte haute capacitée. Adressable par bloc de 512 octets.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>4</center></td><td>F_SDC_TO</td><td>1 &rarr; Si la dernière commande a expirée avant d'aboutir.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>5</center></td><td>F_SDC_WE</td><td>1 &rarr; S'il s'est produit une erreur d'écriture.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>6</center></td><td>F_SDC_RE</td><td>1 &rarr; S'il s'est produit une erreur de lecture.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>7</center></td><td>F_SDC_IE</td><td>1 &rarr; S'il s'est prdouit une erreur d'initialisation.</td></tr>
</div>
<div style="margin-left:5%;">  <tr><td><center>8</center></td><td>F_BAD_CARD</td><td>1 &rarr; S'il n'y a pas de réponse de la carte.</td></tr>
</div>
<div style="margin-left:5%;">  </table><br>
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;  État de la carte.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="?SDCOK">
<b>?SDCOK</b>  ( -- n )    
<div style="margin-left:5%;">   Retourne la valeur du bit F_SDC_OK. La valeur 2 indique qu'il y a une carte
</div>
<div style="margin-left:5%;">   dans la fente et qu'elle est initialisée.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp; Valeur du bit F_SDC_OK &rarr; {0,2}.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCREAD">
<b>SDCREAD</b>  ( c-addr ud -- f )    
<div style="margin-left:5%;">   Lecture d'un secteur de la carte SD, bloc de 512 octets    
</div>
</p>
<div style="margin-left:5%;"><b>  arguments:
</b></div>
<div style="margin-left:5%;"><i>addr</i>&nbsp;&nbsp; Adresse du tampon RAM
</div>
<div style="margin-left:5%;"><i>ud</i>&nbsp;&nbsp;  Numéro du secteur sur la carte SD. 
</div>
<div style="margin-left:5%;"><b>  retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;  Indicateur booléen échec/succcès    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCWRITE">
<b>SDCWRITE</b>   ( addr ud -- )   
<div style="margin-left:5%;">   Écriture d'un secteur de 512 octets sur la carte SD.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>addr</i>&nbsp;&nbsp; Adresse du tampon RAM des données à écrire.
</div>
<div style="margin-left:5%;"><i>ud	</i>&nbsp;&nbsp; Numéro du secteur la carte SD où effectuer l'écriture.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-BLOCKS">
<b>SDC-BLOCKS</b>  ( -- ud )    
<div style="margin-left:5%;">   Nombre de blocs de 1024 octets sur la carte SD.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>ud</i>&nbsp;&nbsp;   Entier double, nombre de blocs.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-SEGMENTS">
<b>SDC-SEGMENTS</b>  ( -- u )    
<div style="margin-left:5%;">   Nombre de segments de 65535 blocs sur la carte SD.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;   Entier simple, nombre de segments.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDBOUND">
<b>SDBOUND</b>  ( n+ -- f)
<div style="margin-left:5%;">   Vérifie si le numéro de bloc est dans les limites
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;  Numéro du bloc à vérifier. {1..65535}
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>f</i>&nbsp;&nbsp;   Indicateur booléen.
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-BLK&gt;ADR">
<b>SDC-BLK&gt;ADR</b>  ( u -- ud )
<div style="margin-left:5%;">   Convertie un numéro de bloc de la carte SD en adresse absolue.
</div>
<div style="margin-left:5%;">   addresse=(u-1)*adr_factor + segment*66535*adr_factor
</div>
<div style="margin-left:5%;">   adr_factor et 1024 pour les cartes V1 et 2 pour les cartes V2.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;    Numéro du bloc {1..65535}
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>ud</i>&nbsp;&nbsp;   Adresse absolue de 32 bits sur la carte SD.
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCARD">
<b>SDCARD</b>  ( -- a-addr )  
<div style="margin-left:5%;">   Descripteur de périphérique pour la carte Secure Digital.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>a-addr</i>&nbsp;&nbsp; Adresse du descripteur de périphérique.  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><h4 id="index">Index</h4>
<p>
<ul>
<li><a href="#?SDC">?SDC</a></li>
<li><a href="#?SDCOK">?SDCOK</a></li>
<li><a href="#CARD-INFO">CARD-INFO</a></li>
<li><a href="#SDBOUND">SDBOUND</a></li>
<li><a href="#SDC-BLK&gt;ADR">SDC-BLK&gt;ADR</a></li>
<li><a href="#SDC-BLOCKS">SDC-BLOCKS</a></li>
<li><a href="#SDC-INIT">SDC-INIT</a></li>
<li><a href="#SDC-R">SDC-R</a></li>
<li><a href="#SDC-SEGMENTS">SDC-SEGMENTS</a></li>
<li><a href="#SDCARD">SDCARD</a></li>
<li><a href="#SDCREAD">SDCREAD</a></li>
<li><a href="#SDCWRITE">SDCWRITE</a></li>
<li><a href="#SEGMENT">SEGMENT</a></li>
<li><a href="#SEGMENT?">SEGMENT?</a></li>
</ul>
</p>
<hr style="border-width:1px;"><div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>

</body>
</html>
