<DOCTYPE! html>
<html lang="fr-CA">
<head>
 <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
 <link rel="stylesheet" type="text/css" href="css/forthex.css"></head>
<body id="#top">
<h1>sdcard</h1><div><a href="#index">index</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<h2 id="description">Description</h2><div>  
</div>
<div> Interface de bas niveau pour l'accès à la carte SD.
</div>
<div> Permet l'initialisation de la carte ainsi que la lecture et l'écriture d'un bloc de
</div>
<div> donnée sur la carte. Cette interface n'est compatible qu'avec les cartes SD V1 et V2.
</div>
<div>REF: <a href=" http://elm-chan.org/docs/mmc/mmc_e.html
"> http://elm-chan.org/docs/mmc/mmc_e.html
</a></div>
<div>REF: <a href=" http://elm-chan.org/docs/mmc/pic/sdinit.png    
"> http://elm-chan.org/docs/mmc/pic/sdinit.png    
</a></div>
<div>REF: <a href=" https://www.sdcard.org/downloads/pls/
"> https://www.sdcard.org/downloads/pls/
</a></div>
<div>  <br>

</div><div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:4px;"><p id="CARD-INFO">
<b>CARD-INFO</b>  ( -- )
<br><div>   Affiche les informations sur la carte SD.
</div>
<div>   La carte doit d'abord avoir été initialisée avec SDC-INIT.
</div>
<div>  <br><table border="single">

  <tr><th>nom</th><th>description</th></tr>  

  <tr><td>VER</td><td> Card version.</td></tr>  

  <tr><td>MID</td><td> Manufacturer ID.</td></tr>

  <tr><td>OID</td><td> OEM/Application ID.</td></tr>

  <tr><td>PNM</td><td> Product name.</td></tr>

  <tr><td>PRV</td><td> Product revision.</td></tr>

  <tr><td>PSN</td><td> Product serial number.</td></tr>

  <tr><td>MTD</td><td> Manufacturing date.</td></tr>

  <tr><td>BLK</td><td> Capacitée en nombre de blocs de 1024 octets.</td></tr>

  <tr><td>SEG</td><td> Nombre de segments, 1 segment correspond à 65535 blocs.</td></tr>    

  </table><br> 

</div></p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-INIT">
<b>SDC-INIT</b> ( -- f )
<br><div>   Initialisation carte SD 
</div>
<div>REF: <a href=" http://elm-chan.org/docs/mmc/pic/sdinit.png    
"> http://elm-chan.org/docs/mmc/pic/sdinit.png    
</a></div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>f</i>&nbsp;&nbsp;   Indicateur Booléen, vrai si l'initialisation est réussie.   
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SEGMENT">
<b>SEGMENT</b> ( u -- )
<br><div>   Détermine quel segment de la carte est actif.
</div>
<div>   Le système définit dans block.s ne permet que d'accéder 65535 blocs sur un périphérique
</div>
<div>   ce qui représente 1024*65535 ou 2^10 * (2^16-1)= 67 107 840 octets.
</div>
<div>   Pour les cartes de plus de 64Mo il faut diviser l'espace de données de la carte
</div>
<div>   en segments de 65535 blocs.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>u</i>&nbsp;&nbsp; Numéro du segment.
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SEGMENT?">
<b>SEGMENT?</b> ( -- u )
<br><div>   Retourne le numéro du segment actif.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>u	Numéro</i>&nbsp;&nbsp; du segment actif {0..SDC-SEGMENTS-1}    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="?SDC">
<b>?SDC</b>  ( -- u )    
<br><div>   Retourne un entier non signé contenant les indicateurs booléen suivants
</div>
<div>  <br><table border="single">    

  <tr><th><center>bit</center></th><th>nom</th><th>description</th></tr>    

  <tr><td><center>0</center></td><td>F_SDC_IN</td><td>1 &rarr; S'il y a une carte dans la fente.</td></tr>

  <tr><td><center>1</center></td><td>F_SDC_OK</td><td>1 &rarr; Si la carte est initialisée.</td></tr>

  <tr><td><center>2</center></td><td>F_SDC_V2</td><td>1  &rarr; S'il s'agit d'une carte version 2.</td></tr>

  <tr><td><center>3</center></td><td>F_SDC_HC</td><td>1 &rarr; S'il s'agit d'une carte haute capacitée. Adressable par bloc de 512 octets.</td></tr>

  <tr><td><center>4</center></td><td>F_SDC_TO</td><td>1 &rarr; Si la dernière commande a expirée avant d'aboutir.</td></tr>

  <tr><td><center>5</center></td><td>F_SDC_WE</td><td>1 &rarr; S'il s'est produit une erreur d'écriture.</td></tr>

  <tr><td><center>6</center></td><td>F_SDC_RE</td><td>1 &rarr; S'il s'est produit une erreur de lecture.</td></tr>

  <tr><td><center>7</center></td><td>F_SDC_IE</td><td>1 &rarr; S'il s'est prdouit une erreur d'initialisation.</td></tr>

  <tr><td><center>8</center></td><td>F_BAD_CARD</td><td>1 &rarr; S'il n'y a pas de réponse de la carte.</td></tr>

  </table><br>

</div></p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>u</i>&nbsp;&nbsp;  État de la carte.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="?SDCOK">
<b>?SDCOK</b>  ( -- n )    
<br><div>   Retourne la valeur du bit F_SDC_OK. La valeur 2 indique qu'il y a une carte
</div>
<div>   dans la fente et qu'elle est initialisée.    
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>n</i>&nbsp;&nbsp; Valeur du bit F_SDC_OK &rarr; {0,2}.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCREAD">
<b>SDCREAD</b>  ( c-addr ud -- f )    
<br><div>   Lecture d'un secteur de la carte SD.
</div>
<div>   Un secteur compte 512 octets.    
</div>
</p>
<div><b>  arguments:
</b></div>
<div><i>addr</i>&nbsp;&nbsp; Adresse du tampon RAM
</div>
<div><i>ud</i>&nbsp;&nbsp;  Numéro du secteur sur la carte SD. 
</div>
<div><b>  retourne:
</b></div>
<div><i>f</i>&nbsp;&nbsp;  Indicateur booléen échec/succcès    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCWRITE">
<b>SDCWRITE</b>   ( addr ud -- )   
<br><div>   Écriture d'un secteur de 512 octets sur la carte SD.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>addr</i>&nbsp;&nbsp; Adresse du tampon RAM des données à écrire.
</div>
<div><i>ud	</i>&nbsp;&nbsp; Numéro du secteur la carte SD où effectuer l'écriture.
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-BLOCKS">
<b>SDC-BLOCKS</b>  ( -- ud )    
<br><div>   Nombre de blocs de 1024 octets sur la carte SD.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>ud</i>&nbsp;&nbsp;   Entier double non signé, nombre de blocs.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDC-SEGMENTS">
<b>SDC-SEGMENTS</b>  ( -- u )    
<br><div>   Nombre de segments de 65535 blocs sur la carte SD.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>u</i>&nbsp;&nbsp;   Entier simple, nombre de segments.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SDCARD">
<b>SDCARD</b>  ( -- a-addr )  
<br><div>   Descripteur de périphérique pour la carte Secure Digital.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>a-addr</i>&nbsp;&nbsp; Adresse du descripteur de périphérique.  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><h4 id="index">Index</h4>
<p>
<ul>
<li><a href="#?SDC">?SDC</a></li>
<li><a href="#?SDCOK">?SDCOK</a></li>
<li><a href="#CARD-INFO">CARD-INFO</a></li>
<li><a href="#SDC-BLOCKS">SDC-BLOCKS</a></li>
<li><a href="#SDC-INIT">SDC-INIT</a></li>
<li><a href="#SDC-SEGMENTS">SDC-SEGMENTS</a></li>
<li><a href="#SDCARD">SDCARD</a></li>
<li><a href="#SDCREAD">SDCREAD</a></li>
<li><a href="#SDCWRITE">SDCWRITE</a></li>
<li><a href="#SEGMENT">SEGMENT</a></li>
<li><a href="#SEGMENT?">SEGMENT?</a></li>
</ul>
</p>
<hr style="border-width:1px;"><div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>

</body>
</html>
