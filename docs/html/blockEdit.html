<DOCTYPE! html>
<html lang="fr-CA">
<head>
 <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
 <link rel="stylesheet" type="text/css" href="css/forthex.css"></head>
<body id="#top">
<h1>blockEdit</h1><div><a href="#index">index</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<h2 id="description">Description</h2><div> 
</div>
<div>   √âditeur de texte simple qui travail sur un seul √©cran √† la fois et permet
</div>
<div>   de sauvegarder le texte de cet √©cran dans un bloc. Ult√©rieurement ce
</div>
<div>   bloc peut-√™tre √©valu√© avec la commande LOAD. 
</div>
<div>   L'id√©e d'un √©diteur de bloc viens de l'origine m√™me du langage. Charles Moore
</div>
<div>   Travaillait sur un terminal vid√©o de 16 lignes de 64 caract√®res, ce qui fait qu'un
</div>
<div>   √©cran occupait 1024 caract√®res. Il avait donc eu l'id√©e de sauvegarder le contenu
</div>
<div>   de la m√©moire vid√©o sur l'unit√© de stockage permanent sans modification.
</div>
<div>   Chaque √©cran sauvegard√© s'appelait un bloc.
</div>
<div>   Le probl√®me c'est que BLKED utilise un √©cran de 23 lignes au lieu de 16 ce qui
</div>
<div>   fait qu'un bloc serait de 1472 caract√®res au lieu de 1024. Mais comme le standard
</div>
<div>   ANSI Forth d√©fini toujours les blocs comme √©tant 1024 caract√®res je devais trouver
</div>
<div>   une solution pour sauvegarder les √©crans dans des blocs. Entre autre solutions il y a
</div>
<div>   1) M'√©carter du standard et modifier la taille des blocs √† 1472 octets.
</div>
<div>   2) Utiliser 2 blocs standards pour sauvegarder un √©cran, occasionne une perte d'espace.
</div>
<div>   3) Compressser le contenu de l'√©cran pour le faire entrer dans un bloc standard, gain d'espace.
</div>
<div>   J'ai opt√© pour la 3i√®me solution.     
</div>
<div>   En principe Lorsqu'on √©cris du code source les lignes ne sont pas pleines.
</div>
<div>   Parfois on laisse m√™me des lignes vides pour rendre le texte plus facile √† lire.
</div>
<div>   Lors de la sauvegarde dans un bloc les lignes sont tronqu√©es apr√®s le dernier caract√®re
</div>
<div>   et un caract√®re de fin de ligne est ajout√©. Il y a 23 lignes de texte sur 
</div>
<div>   un √©cran donc BLKED. Donc si la longueur moyenne des lignes est inf√©rieure √†
</div>
<div>   (BLOCK_SIZE-23)/23 l'√©cran peut √™tre sauvegard√© dans un bloc. Le mot SCR-SIZE
</div>
<div>   d√©fini dans le fichier block.s permet de conna√Ætre la taille occup√©e par un √©cran dans un bloc.
</div>
<div>   Il est problable que dans la majorit√© des cas un √©cran avec les lignes tronqu√©es apr√®s
</div>
<div>   le dernier caract√®re r√©pondra √† ce crit√®re. Au pire il suffira de raccourcir les commentaires.    
</div>
<div> FONCTIONNEMENT:
</div>
<div>   BLKED r√©serve la ligne 24 comme ligne d'√©tat donc un bloc de texte occupe les
</div>
<div>   lignes 1..23.     
</div>
<div>   Le curseur peut-√™tre d√©plac√© n'importe o√π sur l'√©cran et le texte modifi√©.
</div>
<div>   Cependant le curseur ne peut sortir des limites de l'√©cran, il n'y a pas de d√©filement.
</div>
<div>   L'√©diteur fonctionne en mode √©crasement, donc si le curseur est d√©plac√© au dessus d'un
</div>
<div>   caract√®re il sera remplac√© par le caract√®re tap√© √† cet endroit. La seule fa√ßon d'ins√©rer
</div>
<div>   un caract√®re au milieu d'un ligne est d'utiliser la touche INSERT suivie du caract√®re.     
</div>
<div>  <br><table border="single">     
</div>
<div>  <tr><th colspan="2">COMMANDES</th></tr>
</div>
<div>  <tr><th>touche</th><th>fonction</th></tr>
</div>
<div>  <tr><td><center>&uarr;</center></td><td>DÈplace le curseur d'une ligne vers le haut.</td></tr>
</div>
<div>  <tr><td><center>&darr;</center></td><td>DÈplace le curseur d'une ligne vers le bas.</td></tr>
</div>
<div>  <tr><td><center>&larr;</center></td><td>DÈplace le curseur d'un caractËre vers la gauche.</td></tr>
</div>
<div>  <tr><td><center>&rarr;</center></td><td>DÈplace le curseur d'un caractËre vers la droite.</td></tr>    
</div>
<div>  <tr><td><center>&crarr;</center></td><td>Va au dÈbut de la ligne suivante.</td></tr>
</div>
<div>  <tr><td>HOME</td><td>Va au dÈbut de la ligne.</td></tr>
</div>
<div>  <tr><td>END</td><td>Va ‡ la fin de la ligne.</td></tr>
</div>
<div>  <tr><td>PAGE<br>UP</td><td>DÈplace le curseur dans le coin supÈrieur gauche de l'Ècran.</td></tr>
</div>
<div>  <tr><td>PAGE<br>DOWN</td><td>DÈplace le curseur ‡ la fin du texte.</td></tr>    
</div>
<div>  <tr><td>DELETE</td><td>Efface le caractËre ‡ la position du curseur.</td></tr>
</div>
<div>  <tr><td>INSERT</td><td>InsËre un espace ‡ la position du curseur. S'il y a un caractËre ‡ la colonne 64 il est perdu.</td></tr>    
</div>
<div>  <tr><td><center>&lAarr;</center></td><td>Efface le caractËre ‡ gauche du curseur.</td></tr>
</div>
<div>  <tr><td>CTRL-D</td><td>Efface la ligne du curseur et place celui-ci ‡ la marge gauche.</td></tr>     
</div>
<div>  <tr><td>CTRL-K</td><td>Efface ‡ partir du curseur jusqu'‡ la fin de la ligne.</td></tr>    
</div>
<div>  <tr><td>CTRL-L</td><td>Efface tout l'Ècran.</td></tr> 
</div>
<div>  <tr><td>CTRL-X</td><td>Supprime la ligne sur laquelle le curseur rÈside.</td></tr>
</div>
<div>  <tr><td>CTRL-Y</td><td>InsËre une ligne vide ‡ la position du curseur.</td></tr>
</div>
<div>  <tr><td>CTRL-B</td><td>Sauvegarde de l'Ècran dans le bloc.</td></tr>
</div>
<div>  <tr><td>CTRL-V</td><td>Copie le contenu de l'Ècran vers un autre bloc et affiche le nouveau bloc.</td></tr>     
</div>
<div>  <tr><td>CTRL-N</td><td>Sauvegarde le bloc actuel et charge le bloc suivant pour Èdition.</td></tr>
</div>
<div>  <tr><td>CTRL-P</td><td>Sauvegarde le bloc actuel et charge le bloc prÈcÈdent pour Èdition.</td></tr>     
</div>
<div>  <tr><td>CTRL-O</td><td>Sauvegarde le bloc actuel et saisie d'un numÈro de bloc pour Èdition.</td></tr>
</div>
<div>  <tr><td>CTRL-E</td><td>Quitte l'Èditeur, le contenu de l'Ècran n'est pas sauvegardÈ.</td></tr>
</div>
<div>  </table><br>
</div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:4px;"><p id="SAVELINE">
<b>SAVELINE</b> ( n -- )
<div>   Sauvegarde de la ligne d'√©cran 'n' dans le tampon PAD.
</div>
<div>   Pour que RESTORELINE restitue la ligne d'√©cran √† son √©tat original
</div>
<div>   l'application doit √©viter d'√©craser le contenu des 64 premiers caract√®res
</div>
<div>   du  PAD entre les 2 appels.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>n</i>&nbsp;&nbsp; Num√©ro de ligne {1..24}
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="RESTORELINE">
<b>RESTORELINE</b>  ( n -- )
<div>   Restaure la ligne d'√©cran √† partir du tampon PAD.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>n</i>&nbsp;&nbsp; Num√©ro de la ligne √† restaurer {1..24}.
</div>
<div><b> retourne:
</b></div>
<div><i>rien
</i>&nbsp;&nbsp;</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="PROMPT">
<b>PROMPT</b>  ( c-addr u n -- )
<div>   Affiche un message en vid√©o invers√© sur la ligne 'n' de l'√©cran.
</div>
<div>   Utilise SAVELINE pour conserver le contenu original de cette ligne dans
</div>
<div>   la m√©moire tampon PAD.  Les applications qui utilisent PROMPT et doivent restaurer
</div>
<div>   le contenu original de la ligne utilis√©e par PROMPT doivent s'assurer
</div>
<div>   de ne pas √©craser les 64 premiers caract√®res du PAD.
</div>
<div>   Apr√®s l'ex√©cution de PROMPT la sortie vid√©o est en mode invers√©e et le curseur
</div>
<div>   est positionn√© apr√®s le prompt permettant une saisie d'information par l'application.    
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>c-addr</i>&nbsp;&nbsp; Adresse du premier caract√®re du message √† afficher.
</div>
<div><i>u</i>&nbsp;&nbsp; Nombre de caract√®res du message, maximum 63.
</div>
<div><i>n</i>&nbsp;&nbsp; Num√©ro de la ligne sur laquelle le message sera affich√©, {1..24}
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="MSGLINE">
<b>MSGLINE</b>  ( u1 c-addr u2 n -- )
<div>   Affiche un message en inverse vid√©o √† l'√©cran et attend une touche au clavier
</div>
<div>   avant de poursuivre l'ex√©cution l'ex√©cution. Le message doit tenir sur une 
</div>
<div>   seule ligne d'√©cran. Cette ligne d'√©cran est sauvegard√©e et restaur√©e √† la 
</div>
<div>   sortie de ce mot. Le curseur texte est retourn√© √† la position qu'il avait 
</div>
<div>   avant l'appel de MSGLINE.    
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>u1</i>&nbsp;&nbsp; Dur√©e maximale d'attente en msec ou z√©ro pour attendre ind√©finiment.    
</div>
<div><i>c-addr</i>&nbsp;&nbsp; Adresse du premier caract√®re du message.
</div>
<div><i>u1</i>&nbsp;&nbsp;  Longueur du message, limit√© √† 63 caract√®res.
</div>
<div><i>n</i>&nbsp;&nbsp;  Num√©ro de la ligne o√π doit-√™tre affich√© le message.
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SCR-SIZE">
<b>SCR-SIZE</b> ( -- n )
<div>    Calcule la taille que la m√©moire tampon vid√©o occuperait dans un bloc 
</div>
<div>    s'il √©tait sauvegard√© avec SCR&gt;BLK. Seul les lignes 1..23 sont sauvegard√©es.
</div>
<div>    BLKED utilise la ligne 24 comme ligne d'√©tat.    
</div>
<div>        
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>aucun
</i>&nbsp;&nbsp;</div>
<div><b> retourne:
</b></div>
<div><i>n</i>&nbsp;&nbsp; Taille qui serait occup√©e par l'√©cran dans un bloc.    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="BLK&gt;SCR">
<b>BLK&gt;SCR</b> ( n+ -- )
<div>   Copie le contenu d'un bloc dans le tampon d'√©cran arr√™te au premier
</div>
<div>   caract√®re non valide.
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>n+</i>&nbsp;&nbsp; Num√©ro du bloc.
</div>
<div><b> retourne:
</b></div>
<div><i>rien
</i>&nbsp;&nbsp;</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="SCR&gt;BLK">
<b>SCR&gt;BLK</b>  ( n+ -- f )
<div>   Sauvegarde de la m√©moire tampon de l'√©cran dans un bloc sur p√©riph√©rique de stockage.
</div>
<div>   Seul lignes 1..23 sont sauvegard√©es.    
</div>
<div>   Si le contenu de l'√©cran n'entre pas dans un bloc, l'op√©ration est abaondonn√©e et retourne faux.
</div>
<div>   Les espaces qui termines les lignes sont supprim√©s et chaque ligne est compl√©t√©e
</div>
<div>   par un VK_CR.
</div>
<div>   * ne fonctionne qu'avec LOCAL CONSOLE. Cependant BLKEDIT utilise le frame buffer
</div>
<div>     local m√™me lorsque la console est en mode REMOTE, donc BLKEDIT peut sauvegarder
</div>
<div>     le bloc en √©dition.    
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>n+</i>&nbsp;&nbsp;    num√©ro du bloc o√π sera sauvegard√© l'√©cran.
</div>
<div><b> retourne:
</b></div>
<div><i>f</i>&nbsp;&nbsp;     indicateur bool√©en, T si sauvegarde r√©ussie, F si trop grand.
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><p id="BLKED">
<b>BLKED</b>  ( n+ -- )  
<div>   √âditeur de bloc texte. Edite 1 bloc √† la fois.
</div>
<div>   Le curseur peut-√™tre d√©plac√© √† n'importe qu'elle position sur l'√©cran et 
</div>
<div>   son contenu modifi√© √† volont√© avant de le sauvegarder le bloc sur le
</div>
<div>   p√©riph√©irque de stockage actif. Si ce bloc contient du texte source ForthEx
</div>
<div>   il peut-√™tre ult√©rieurement √©valu√© par la commande LOAD ou THRU.  
</div>
</p>
<div><b> arguments:
</b></div>
<div><i>n+</i>&nbsp;&nbsp;   Le num√©ro du bloc √† √©diter.
</div>
<div><b> retourne:
</b></div>
<div><i>rien</i>&nbsp;&nbsp;  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>
<hr style="border-width:1px;"><h4 id="index">Index</h4>
<p>
<ul>
<li><a href="#BLK&gt;SCR">BLK&gt;SCR</a></li>
<li><a href="#BLKED">BLKED</a></li>
<li><a href="#MSGLINE">MSGLINE</a></li>
<li><a href="#PROMPT">PROMPT</a></li>
<li><a href="#RESTORELINE">RESTORELINE</a></li>
<li><a href="#SAVELINE">SAVELINE</a></li>
<li><a href="#SCR&gt;BLK">SCR&gt;BLK</a></li>
<li><a href="#SCR-SIZE">SCR-SIZE</a></li>
</ul>
</p>
<hr style="border-width:1px;"><div><a href="#top">haut</a></div>
<div><a href="index.html#MasterIndex">index principal</a></div>

</body>
</html>
