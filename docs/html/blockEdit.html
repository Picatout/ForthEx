<DOCTYPE! html>
<html lang="fr-CA">
<head>
</head>
<body id="#top">
<h1>blockEdit</h1><div><a href="#index">index</a></div>
<div><a href="index.html">index principal</a></div>
<h2 id="description">Description</h2><div style="margin-left:5%;"> 
</div>
<div style="margin-left:5%;">   Éditeur de texte simple qui travail sur un seul écran à la fois et permet
</div>
<div style="margin-left:5%;">   de sauvegarder le texte de cet écran dans un bloc. Ultérieurement ce
</div>
<div style="margin-left:5%;">   bloc peut-être évalué avec la commande LOAD. 
</div>
<div style="margin-left:5%;">   L'idée d'un éditeur de bloc viens de l'origine même du langage. Charles Moore
</div>
<div style="margin-left:5%;">   Travaillait sur un terminal vidéo de 16 lignes de 64 caractères, ce qui fait qu'un
</div>
<div style="margin-left:5%;">   écran occupait 1024 caractères. Il avait donc eu l'idée de sauvegarder le contenu
</div>
<div style="margin-left:5%;">   de la mémoire vidéo sur l'unité de stockage permanent sans modification.
</div>
<div style="margin-left:5%;">   Chaque écran sauvegardé s'appelait un bloc.
</div>
<div style="margin-left:5%;">   Le problème c'est que ForthEx utilise un écran de 24 lignes au lieu de 16 ce qui
</div>
<div style="margin-left:5%;">   fait qu'un bloc serait de 1536 caractères au lieu de 1024. Mais comme le standard
</div>
<div style="margin-left:5%;">   ANS Forth définie toujours les blocs comme étant 1024 caractères je devais trouver
</div>
<div style="margin-left:5%;">   une solution pour sauvegarder les écrans dans des blocs. Entre autre solutions il y a
</div>
<div style="margin-left:5%;">   1) M'écarter du standard et modifier la taille des blocs à 1536 octets.
</div>
<div style="margin-left:5%;">   2) Utiliser 2 blocs standards pour sauvegarder un écran, occasionne une perte d'espace.
</div>
<div style="margin-left:5%;">   3) Compressser le contenu de l'écran pour le faire entrer dans un bloc standard, gain d'espace.
</div>
<div style="margin-left:5%;">   J'ai opté pour la 3ième solution.     
</div>
<div style="margin-left:5%;">   En principe Lorsqu'on écris du code source les lignes ne sont pas pleines.
</div>
<div style="margin-left:5%;">   Parfois on laisse même des lignes vides pour rendre le texte plus facile à lire.
</div>
<div style="margin-left:5%;">   Lors de la sauvegarde dans un bloc les lignes sont tronquées après le dernier caractère
</div>
<div style="margin-left:5%;">   et un caractère de fin de ligne est ajouté. Il y a 24 lignes sur un écran donc
</div>
<div style="margin-left:5%;">   si la longueur moyenne des lignes est inférieure à (BLOCK_SIZE-24)/24 l'écran peut
</div>
<div style="margin-left:5%;">   être sauvegardé dans un bloc. Le mot SCR-SIZE défini dans le fichier block.s
</div>
<div style="margin-left:5%;">   permet de connaître la taille occupée par un écran dans un bloc.
</div>
<div style="margin-left:5%;">   Il est problable que la majorité du temps un écran avec les lignes tronquées après
</div>
<div style="margin-left:5%;">   le dernier caractère répondra à ce critère. Au pire il suffira de raccourcir les commentaires.    
</div>
<div style="margin-left:5%;"> FONCTIONNEMENT:
</div>
<div style="margin-left:5%;">   Le curseur peut-être déplacé n'importe où sur l'écran et le texte modifié.
</div>
<div style="margin-left:5%;">   Cependant le curseur ne peut sortir des limites de l'écran, il n'y a pas de défilement.
</div>
<div style="margin-left:5%;">   L'éditeur fonctionne en mode écrasement, donc si le curseur est déplacé au dessus d'un
</div>
<div style="margin-left:5%;">   caractère il sera remplacé par le caractère tapé à cet endroit. La seule façon d'insérer
</div>
<div style="margin-left:5%;">   un caractère au milieu d'un ligne est d'utiliser la touche INSERT suivie du caractère.     
</div>
<div style="margin-left:5%;"> COMMANDES:
</div>
<div style="margin-left:5%;">   Déplacement du curseur:
</div>
<div style="margin-left:5%;">   UP Déplace le curseur sur la ligne supérieure.
</div>
<div style="margin-left:5%;">   DOWN Déplace le curseur sur la ligne suivante.
</div>
<div style="margin-left:5%;">   LEFT Déplace le curseur d'un caractère vers la gauche.
</div>
<div style="margin-left:5%;">   RIGHT Déplace le curseur d'un caractère vers la droite.    
</div>
<div style="margin-left:5%;">   HOME   Va au début de la ligne.
</div>
<div style="margin-left:5%;">   END    Va à la fin de la ligne.
</div>
<div style="margin-left:5%;">   PGUP   Déplace le curseur dans le coin supérieur gauche de l'écran.
</div>
<div style="margin-left:5%;">   PGDN   Déplace le curseur à la fin du texte.    
</div>
<div style="margin-left:5%;">   Édition:   
</div>
<div style="margin-left:5%;">   L'éditeur fonctionne en mode écrasement, i.e. le caractère est placé à la 
</div>
<div style="margin-left:5%;">   position du curseur et le curseur est avancé d'une position vers la droite.    
</div>
<div style="margin-left:5%;">   DELETE  Efface le caractère à la position du curseur.
</div>
<div style="margin-left:5%;">   INSERT  Insère un espace à la position du curseur. S'il y a un caractère à la colonne 64 il est perdu.    
</div>
<div style="margin-left:5%;">   BACKSPACE Efface le caractère à gauche du curseur.
</div>
<div style="margin-left:5%;">   CTRL_A  Efface tout l'écran.     
</div>
<div style="margin-left:5%;">   CTRL_K  Efface à partir du curseur jusqu'à la fin de la ligne    
</div>
<div style="margin-left:5%;">   CTRL_X  Supprime la ligne sur laquelle le curseur réside.
</div>
<div style="margin-left:5%;">   CTRL_Y  Insère une ligne vide avant celle où se trouve le curseur.
</div>
<div style="margin-left:5%;">   Manipulation des blocs:    
</div>
<div style="margin-left:5%;">   CTRL_B  Affiche le numéro du bloc en édition ainsi que sa taille.    
</div>
<div style="margin-left:5%;">   CTRL_S  Sauvegarde de l'écran dans le bloc.
</div>
<div style="margin-left:5%;">   CTRL_N  Sauvegarde le bloc actuel et charge le bloc suivant pour édition.
</div>
<div style="margin-left:5%;">   CTRL_P  Sauvegarde le bloc actuel et charge le bloc précédent pour édition.     
</div>
<div style="margin-left:5%;">   CTRL_I  Sauvegarde le bloc actuel et saisie d'un numéro de bloc pour édition.
</div>
<div style="margin-left:5%;">   CTRL_Q  Quitte l'éditeur,le contenu de l'écran n'est pas sauvegardé.
</div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:4px;"><p id="TEXTEND">
<b>TEXTEND</b>  ( -- )
<div style="margin-left:5%;">   Positionne le curseur à la fin du texte. Balaie la mémoire tampon de l'écran à partir
</div>
<div style="margin-left:5%;">   de la fin et s'arrête après le premier caractère non blanc.     
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>aucun
</i>&nbsp;&nbsp;</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp; 
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="SAVELINE">
<b>SAVELINE</b> ( n -- )
<div style="margin-left:5%;">   Sauvegarde de la ligne d'écran 'n' dans le tampon PAD.
</div>
<div style="margin-left:5%;">   Pour que RESTORELINE restitue la ligne d'écran à son état original
</div>
<div style="margin-left:5%;">   l'application doit éviter d'écraser le contenu des 64 premiers caractères
</div>
<div style="margin-left:5%;">   du  PAD entre les 2 appels.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp; Numéro de ligne {1..24}
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="RESTORELINE">
<b>RESTORELINE</b>  ( n -- )
<div style="margin-left:5%;">   Restaure la ligne d'écran à partir du tampon PAD.
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp; Numéro de la ligne à restaurer {1..24}.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien
</i>&nbsp;&nbsp;</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="PROMPT">
<b>PROMPT</b>  ( c-addr u n -- )
<div style="margin-left:5%;">   Affiche un message en vidéo inversé sur la ligne 'n' de l'écran.
</div>
<div style="margin-left:5%;">   Utilise SAVELINE pour conserver le contenu original de cette ligne dans
</div>
<div style="margin-left:5%;">   la mémoire tampon PAD.  Les applications qui utilisent PROMPT et doivent restaurer
</div>
<div style="margin-left:5%;">   le contenu original de la ligne utilisée par PROMPT doivent s'assurer
</div>
<div style="margin-left:5%;">   de ne pas écraser les 64 premiers caractères du PAD.
</div>
<div style="margin-left:5%;">   Après l'exécution de PROMPT la sortie vidéo est en mode inversée et le curseur
</div>
<div style="margin-left:5%;">   est positionné après le prompt permettant une saisie d'information par l'application.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp; Adresse du premier caractère du message à afficher.
</div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp; Nombre de caractères du message, maximum 63.
</div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp; Numéro de la ligne sur laquelle le message sera affiché, {1..24}
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;    
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="MSGLINE">
<b>MSGLINE</b>  ( c-addr u n -- )
<div style="margin-left:5%;">   Affiche un message à l'écran et attend une touche au clavier pour poursuivre
</div>
<div style="margin-left:5%;">   l'exécution. Le message doit tenir sur une seule ligne d'écran. Cette ligne
</div>
<div style="margin-left:5%;">   d'écran est sauvegardée et restaurée à la sortie de ce mot. Le curseur texte
</div>
<div style="margin-left:5%;">   est retourné à la position qu'il avait avant l'appel de MSGLINE.    
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>c-addr</i>&nbsp;&nbsp; Adresse du premier caractère du message.
</div>
<div style="margin-left:5%;"><i>u</i>&nbsp;&nbsp;  Longueur du message, limité à 63 caractères.
</div>
<div style="margin-left:5%;"><i>n</i>&nbsp;&nbsp;  Numéro de la ligne où doit-être affiché le message.
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><p id="BLKED">
<b>BLKED</b>  ( n+ -- )  
<div style="margin-left:5%;">   Éditeur de bloc texte. Edite 1 bloc à la fois.
</div>
<div style="margin-left:5%;">   Le curseur peut-être déplacé à n'importe qu'elle position sur l'écran et 
</div>
<div style="margin-left:5%;">   son contenu modifié à volonté avant de le sauvegarder le bloc sur le
</div>
<div style="margin-left:5%;">   périphéirque de stockage actif. Si ce bloc contient du texte source ForthEx
</div>
<div style="margin-left:5%;">   il peut-être ultérieurement évalué par la commande LOAD ou THRU.  
</div>
</p>
<div style="margin-left:5%;"><b> arguments:
</b></div>
<div style="margin-left:5%;"><i>n+</i>&nbsp;&nbsp;   Le numéro du bloc à éditer.
</div>
<div style="margin-left:5%;"><b> retourne:
</b></div>
<div style="margin-left:5%;"><i>rien</i>&nbsp;&nbsp;  
</div>
<div><a href="#index">index</a></div>
<div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>
<hr style="border-width:1px;"><h4 id="index">Index</h4>
<p>
<ul>
<li><a href="#BLKED">BLKED</a></li>
<li><a href="#MSGLINE">MSGLINE</a></li>
<li><a href="#PROMPT">PROMPT</a></li>
<li><a href="#RESTORELINE">RESTORELINE</a></li>
<li><a href="#SAVELINE">SAVELINE</a></li>
<li><a href="#TEXTEND">TEXTEND</a></li>
</ul>
</p>
<hr style="border-width:1px;"><div><a href="#top">haut</a></div>
<div><a href="index.html">index principal</a></div>

</body>
</html>
